<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LWS Assignment 1 - Scoreboard</title>
    <link rel="icon" type="image/x-icon" href="./image/favicon.png" />
    <link rel="stylesheet" href="./style.css" />
    <script src="https://unpkg.com/redux@latest/dist/redux.min.js"></script>
  </head>

  <body>
    <section class="section">
      <!-- header -->
      <header class="header">
        <div class="container">
          <div class="header-wrapper">
            <img src="./image/lws-logo 1.svg" alt="logo" class="logo" />
            <h1 class="name">Scoreboard</h1>
            <h5 class="total">Total</h5>
          </div>
        </div>
      </header>
      <!-- matches  -->
      <div class="all-matches container">
        <!-- Each form tag is Each row, This will render multiple times on Clicking 'Add Another Match' -->
        <div class="match">
          <div class="wrapper">
            <button class="lws-delete">
              <img src="./image/delete.svg" alt="" />
            </button>
            <h3 class="lws-matchName">Match 1</h3>
          </div>
          <div class="inc-dec">
            <form class="incrementForm">
              <h4>Increment</h4>
              <input type="number" name="increment" class="lws-increment" />
            </form>
            <form class="decrementForm">
              <h4>Decrement</h4>
              <input type="number" name="decrement" class="lws-decrement" />
            </form>
          </div>
          <div class="numbers">
            <h2 class="lws-singleResult">120</h2>
          </div>
        </div>
      </div>
      <!-- for adding another matches -->
      <div class="add_match">
        <button class="btn lws-addMatch">Add Another Match</button>
        <button class="lws-reset">
          <svg
            fill="none"
            width="24"
            height="24"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
            ></path>
          </svg>
          <span>Reset</span>
        </button>
      </div>
    </section>
    <section class="mask"></section>

    <script>
      // Actions
      const ADD_MATCH = "ADD_MATCH";
      const DELETE_MATCH = "DELETE_MATCH";
      const INCREMENT_SCORE = "INCREMENT_SCORE";
      const DECREMENT_SCORE = "DECREMENT_SCORE";
      const RESET_SCORES = "RESET_SCORES";

      // Action creators
      const addMatch = () => ({ type: ADD_MATCH });
      const deleteMatch = (matchId) => ({ type: DELETE_MATCH, matchId });
      const incrementScore = (matchId, value) => ({
        type: INCREMENT_SCORE,
        matchId,
        value,
      });
      const decrementScore = (matchId, value) => ({
        type: DECREMENT_SCORE,
        matchId,
        value,
      });
      const resetScores = () => ({ type: RESET_SCORES });

      // Reducers
      const matchReducer = (state = { score: 0 }, action) => {
        console.log(state.score);
        switch (action.type) {
          case INCREMENT_SCORE:
            return { ...state, score: state.score + action.value };
          case DECREMENT_SCORE:
            return {
              ...state,
              score: Math.max(state.score - action.value, 0),
            };
          default:
            return state;
        }
      };

      const matchesReducer = (state = [], action) => {
        switch (action.type) {
          case ADD_MATCH:
            return [...state, matchReducer(undefined, action)];
          case DELETE_MATCH:
            return state.filter((match, i) => i !== action.matchId);
          case INCREMENT_SCORE:
          case DECREMENT_SCORE:
            return state.map((match, i) =>
              i === action.matchId ? matchReducer(match, action) : match
            );
          case RESET_SCORES:
            return state.map((match) => ({ ...match, score: 0 }));
          default:
            return state;
        }
      };

      const rootReducer = combineReducers({
        matches: matchesReducer,
      });

      // Store
      const store = createStore(rootReducer);

      // Components
      const Match = ({ matchId }) => {
        const match = useSelector((state) => state.matches[matchId]);
        const dispatch = useDispatch();

        const handleIncrement = (e) => {
          if (e.key === "Enter") {
            const value = parseInt(e.target.value, 10) || 1;
            dispatch(incrementScore(matchId, value));
            e.target.value = "";
          }
        };

        const handleDecrement = (e) => {
          if (e.key === "Enter") {
            const value = parseInt(e.target.value, 10) || 1;
            dispatch(decrementScore(matchId, value));
            e.target.value = "";
          }
        };

        const handleDelete = () => {
          dispatch(deleteMatch(matchId));
        };

        return `<div>
            <button onClick={handleDecrement}>-</button>
            <button onClick={handleIncrement}>+</button>
            <button onClick={handleDelete}>âœ“</button>
          </div>`;
      };
    </script>
  </body>
</html>
